C51 COMPILER V9.60.0.0   CODINGSWITCH                                                      05/09/2023 16:49:07 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE CODINGSWITCH
OBJECT MODULE PLACED IN .\Output\codingSwitch.obj
COMPILER INVOKED BY: D:\Program_Files\KEIL5_521A\C51\BIN\C51.EXE Application_Library\codingSwitch.c OMF2 OPTIMIZE(8,SPEE
                    -D) BROWSE INCDIR(.\Inc;.\User;.\Application_Library;.\Project) DEBUG PRINT(.\List\codingSwitch.lst) OBJECT(.\Output\codi
                    -ngSwitch.obj)

line level    source

   1          
   2          #include        "..\Application_Library\Global.h"
   3          
   4          #include    <intrins.h>
   5          #include        "codingSwitch.h"        
   6          #include        "codingSwitch_user.h"   
   7          
   8          #if     (c_codingSwitch_en&&c_codingSwitch_user_en)     
              
                      typedef struct
                      {
                              uchar   status;                 //ÓÃÓÚ´æ´¢Ò»¸öÖÜÆÚÀïµÄÖµ,³õÊ¼»¯Îª0x03
                              uchar   order;                  //´ÎÊý¼ÆÊý,Ò»¸öÖÜÆÚÓÐ4´Î
                              uchar   value;                  //0:ÎÞ¶¯×÷,1:Õý×ª,2:·´×ª
                              uchar   getOne;                 //1:»ñÈ¡ÁËÐý×ªÖµ
                              uchar   io_differCnt;   //Ïû¶¶¼ÆÊý
                      }str_codingSwitch;
              
                      str_codingSwitch        idata   bs_codingSwitch;
                      str_codingSwitch        idata   bs_codingSwitch2;
              
              
              /***********************************************************
              ;º¯ÊýÃû³Æ:void  codingSwitch_init(void)
              ;º¯Êý¹¦ÄÜ:IO¿Ú¼°±äÁ¿³õÊ¼»¯
              ;ÊäÈë²ÎÊý:ÎÞ
              ;Êä³ö²ÎÊý:ÎÞ    
              ;Ê¹ÓÃ×¢Òâ:
              ;--------
              ;---------
              ;---------
              ;**********************************************************/
                      void    codingSwitch_init(void)
                      {       
                              /*ÓÃµ½µÄIO¿Ú¶¼ÉèÎªÉÏÀ­ÊäÈë*/
                              /*Ðý×ª±àÂë¿ª¹Ø1 A*/
                              p_codingSwitch_io1_in;
                              p_codingSwitch_io1_pull;
                              p_codingSwitch_io1_h;
              
                              /*Ðý×ª±àÂë¿ª¹Ø1 B*/
                              p_codingSwitch_io2_in;
                              p_codingSwitch_io2_pull;
                              p_codingSwitch_io2_h;
              
                              /*Ðý×ª±àÂë¿ª¹Ø2 A*/
                              p_codingSwitch_io3_in;
                              p_codingSwitch_io3_pull;
                              p_codingSwitch_io3_h;
              
                              /*Ðý×ª±àÂë¿ª¹Ø2 B*/
                              p_codingSwitch_io4_in;
                              p_codingSwitch_io4_pull;
C51 COMPILER V9.60.0.0   CODINGSWITCH                                                      05/09/2023 16:49:07 PAGE 2   

                              p_codingSwitch_io4_h;
              
              
              
              
                              /*½á¹¹Ìå³õÊ¼»¯*/
                              //memset(&bs_codingSwitch,0,sizeof(str_codingSwitch));
                              bs_codingSwitch.status=0;               
                              bs_codingSwitch.order=0;                
                              bs_codingSwitch.value=0;                
                              bs_codingSwitch.getOne=0;               
                              bs_codingSwitch.io_differCnt=0;
              
                              bs_codingSwitch2.status=0;              
                              bs_codingSwitch2.order=0;               
                              bs_codingSwitch2.value=0;               
                              bs_codingSwitch2.getOne=0;              
                              bs_codingSwitch2.io_differCnt=0;
              
              
              
                              bs_codingSwitch.status=0x03;
                              bs_codingSwitch2.status=0x03;
                      }
              
              
              
              
              /***********************************************************
              ;º¯ÊýÃû³Æ:void  codingSwitch_distinguish(uchar cmd)
              ;º¯Êý¹¦ÄÜ:ÉèÖÃ±àÂë¿ª¹Ø¹¤×÷×´Ì¬
              ;ÊäÈë²ÎÊý:cmd
                               0:disable
                               1:enable
              ;Êä³ö²ÎÊý:              
              ;Ê¹ÓÃ×¢Òâ:·ÅÓÚ¶¨Ê±ÖÐ¶Ï
              ;--------
              ;---------
              ;---------
              ;**********************************************************/
                      void    codingSwitch_distinguish(uchar cmd)
                      {                       
                              static  uchar   i;              //±¾ÖÐ¶Ï»ñÈ¡µÄ±àÂëÖµ
                              static  uchar   buf;    //ÉÏÒ»¸öÖÐ¶Ï»ñÈ¡µÄ±àÂëÖµ
              
                              /*Èç¹û²»Ê¹ÄÜ±àÂë¿ª¹Ø¹¤×÷,ÔòÄ¬ÈÏAB¶¼Îª¸ß*/
                              if(cmd==0)
                              {
                                      i=0x03;
                                      buf=0x03;
                                      bs_codingSwitch.order=0;
                                      bs_codingSwitch.status=0x03;    
                                      bs_codingSwitch.value=0;                //0ÎÞ¶¯×÷
                      
                                      bs_codingSwitch.io_differCnt=0;         //Ïû¶¶¼ÆÊý
                                      return;
                              }
              
                              /*ÕâÀïµÄio1´ú±íµÄÊÇA,io2´ú±íµÄÊÇB*/
                              if(p_codingSwitch_io1_get)
                              {
                                      i |=0x02;                                       
C51 COMPILER V9.60.0.0   CODINGSWITCH                                                      05/09/2023 16:49:07 PAGE 3   

                              }
                              else
                              {
                                      i &=~0x02;
                              }
                              
                              if(p_codingSwitch_io2_get)
                              {
                                      i |=0x01;       
                              }
                              else
                              {
                                      i &=~0x01;                      
                              }
              
                              if((bs_codingSwitch.status&0x03)!=i)    //»ñÈ¡µÄÖµ,¶Ô±ÈÇ°Ò»¸öÏû¶¶ºóµÄÖµÓÐ¸Ä±äÔò½øÈë
                              {
                                      if(i==buf)      //±¾´Î»ñÈ¡µÄ±àÂëÖµºÍÉÏ´Î»ñÈ¡µÄ±àÂëÖµÒ»Ñù,ËµÃ÷Ã»ÓÐ¶¶¶¯
                                      {
                                              if(++bs_codingSwitch.io_differCnt>=c_codingSwitch_ioShake)              //Ïû¶¶¼ÆÊý
                                              {       
                                                      bs_codingSwitch.io_differCnt=0;         //Çå Ïû¶¶¼ÆÊý
                                                      /*************Ïû¶¶Íê³É,i´æ´¢µÄÊÇ¿ÉÓÃµÄÊý¾Ý******************/
                                                      /*ÕûÌåÓÒÒÆÁ½Î»,µÍÁ½Î»ÓÃÀ´´æ´¢µ±Ç°1´Î±àÂëÖµ*/
                                                      bs_codingSwitch.status <<=2;            
                                                      bs_codingSwitch.status +=i;     
                                                      if(++bs_codingSwitch.order==4)
                                                      {
                                                              /*Õý³£À´Ëµ,²âµÃbs_codingSwitch.statusÊýÖµÎª 
                                                              Ë³:
                                                              01001011 
                                                              ABABABAB
                                                              
                                                              Äæ
                                                              10000111
                                                              ABABABAB
                                                              
                                                              */
                                                      #if     (c_codingSwitch_strengthenMode==0)              //¼ì²âÇ¿¶ÈµÈ¼¶0~2£¬ÖµÔ½´ó¿¹¸ÉÈÅÐÔÔ½Ç¿µ«Ò²Ðí»á´Ë³öÏÖÐ¡¸ÅÂÊµÄÂ©
             -¼ì
                                                              bs_codingSwitch.status=bs_codingSwitch.status&0xf0;
                                                              if(bs_codingSwitch.status==b(01000000))
                                                              {                               
                                                                      bs_codingSwitch.value=1;
                                                              }
                                                              else if(bs_codingSwitch.status==b(10000000))
                                                              {
                                                                      bs_codingSwitch.value=2;
                                                              }
                                                              else
                                                              {
                                                                      bs_codingSwitch.value=0;
                                                              }
                                                      #elif   (c_codingSwitch_strengthenMode==1)      //¼ì²âÇ¿¶ÈµÈ¼¶0~2£¬ÖµÔ½´ó¿¹¸ÉÈÅÐÔÔ½Ç¿µ«Ò²Ðí»á´Ë³öÏÖÐ¡¸ÅÂÊµÄÂ
             -©¼ì
                                                              bs_codingSwitch.status=bs_codingSwitch.status&0xfc;     //1111 1100
                                                              if(bs_codingSwitch.status==b(01001000))
                                                              {                               
                                                                      bs_codingSwitch.value=1;        //1:Õý×ª
                                                              }
                                                              else if(bs_codingSwitch.status==b(10000100))
                                                              {
C51 COMPILER V9.60.0.0   CODINGSWITCH                                                      05/09/2023 16:49:07 PAGE 4   

                                                                      bs_codingSwitch.value=2;        //2:·´×ª
                                                              }
                                                              else
                                                              {
                                                                      bs_codingSwitch.value=0;        //0:ÎÞ¶¯×÷
                                                              }
                                                      #else                                                                           //¼ì²âÇ¿¶ÈµÈ¼¶0~2£¬ÖµÔ½´ó¿¹¸ÉÈÅÐÔÔ½Ç¿µ«Ò²Ðí»á´Ë³öÏÖÐ¡¸ÅÂÊµÄÂ©¼ì
                                                              if(bs_codingSwitch.status==b(01001011))
                                                              {                               
                                                                      bs_codingSwitch.value=1;
                                                              }
                                                              else if(bs_codingSwitch.status==b(10000111))
                                                              {
                                                                      bs_codingSwitch.value=2;
                                                              }
                                                              else
                                                              {
                                                                      bs_codingSwitch.value=0;
                                                              }       
                                                      #endif          
                                                              bs_codingSwitch.order=0;                //´ÎÊý¼ÆÊý,Ò»¸öÖÜÆÚÓÐ4´Î
                                                              bs_codingSwitch.status=0x03;    //ÓÃÓÚ´æ´¢Ò»¸öÖÜÆÚÀïµÄÖµ,³õÊ¼»¯Îª0x03
                                                              bs_codingSwitch.getOne=1;               //1:»ñÈ¡ÁËÐý×ªÖµ
                                                                      
                                                      }
                                                      else
                                                      {
                                                              //²»ÊÇµÚ4´ÎÈ´¶Áµ½11ÔòÈÏÎª´íÎóÖØÐÂ¿ªÊ¼¶ÁÈ¡
                                                              if(i==0x03)
                                                              {
                                                                      bs_codingSwitch.order=0;
                                                                      bs_codingSwitch.status=0x03;    
                                                              }
              
                                                      }
                                              }
                                      }
                                      else
                                      {
                                              buf=i;
                                              bs_codingSwitch.io_differCnt=0;         //Ïû¶¶¼ÆÊý
                                      }
                              }
                              else
                              {
                                      bs_codingSwitch.io_differCnt=0;                 //Ïû¶¶¼ÆÊý
                                      buf=i;
                              }
                                                      
                      }
              
              
              
              /***********************************************************
              ;º¯ÊýÃû³Æ:void  codingSwitch_distinguish2(uchar cmd)
              ;º¯Êý¹¦ÄÜ:ÉèÖÃ±àÂë¿ª¹Ø¹¤×÷×´Ì¬(Ðý×ª±àÂë¿ª¹Ø2)
              ;ÊäÈë²ÎÊý:cmd
                               0:disable
                               1:enable
              ;Êä³ö²ÎÊý:              
              ;Ê¹ÓÃ×¢Òâ:·ÅÓÚ¶¨Ê±ÖÐ¶Ï
              ;--------
C51 COMPILER V9.60.0.0   CODINGSWITCH                                                      05/09/2023 16:49:07 PAGE 5   

              ;---------
              ;---------
              ;**********************************************************/
                      void    codingSwitch_distinguish2(uchar cmd)
                      {                       
                              static  uchar   i;              //±¾ÖÐ¶Ï»ñÈ¡µÄ±àÂëÖµ
                              static  uchar   buf;    //ÉÏÒ»¸öÖÐ¶Ï»ñÈ¡µÄ±àÂëÖµ
              
                              /*Èç¹û²»Ê¹ÄÜ±àÂë¿ª¹Ø¹¤×÷,ÔòÄ¬ÈÏAB¶¼Îª¸ß*/
                              if(cmd==0)
                              {
                                      i=0x03;
                                      buf=0x03;
                                      bs_codingSwitch2.order=0;
                                      bs_codingSwitch2.status=0x03;   
                                      bs_codingSwitch2.value=0;               //0ÎÞ¶¯×÷
                      
                                      bs_codingSwitch2.io_differCnt=0;                //Ïû¶¶¼ÆÊý
                                      return;
                              }
              
                              /*ÕâÀïµÄio3´ú±íµÄÊÇA,io4´ú±íµÄÊÇB*/
                              if(p_codingSwitch_io3_get)
                              {
                                      i |=0x02;                                       
                              }
                              else
                              {
                                      i &=~0x02;
                              }
                              
                              if(p_codingSwitch_io4_get)
                              {
                                      i |=0x01;       
                              }
                              else
                              {
                                      i &=~0x01;                      
                              }
              
                              if((bs_codingSwitch2.status&0x03)!=i)   //»ñÈ¡µÄÖµ,¶Ô±ÈÇ°Ò»¸öÏû¶¶ºóµÄÖµÓÐ¸Ä±äÔò½øÈë
                              {
                                      if(i==buf)      //±¾´Î»ñÈ¡µÄ±àÂëÖµºÍÉÏ´Î»ñÈ¡µÄ±àÂëÖµÒ»Ñù,ËµÃ÷Ã»ÓÐ¶¶¶¯
                                      {
                                              if(++bs_codingSwitch2.io_differCnt>=c_codingSwitch_ioShake)             //Ïû¶¶¼ÆÊý
                                              {       
                                                      bs_codingSwitch2.io_differCnt=0;                //Çå Ïû¶¶¼ÆÊý
                                                      /*************Ïû¶¶Íê³É,i´æ´¢µÄÊÇ¿ÉÓÃµÄÊý¾Ý******************/
                                                      /*ÕûÌåÓÒÒÆÁ½Î»,µÍÁ½Î»ÓÃÀ´´æ´¢µ±Ç°1´Î±àÂëÖµ*/
                                                      bs_codingSwitch2.status <<=2;           
                                                      bs_codingSwitch2.status +=i;    
                                                      if(++bs_codingSwitch2.order==4)
                                                      {
                                                              /*Õý³£À´Ëµ,²âµÃbs_codingSwitch.statusÊýÖµÎª 
                                                              Ë³:
                                                              01001011 
                                                              ABABABAB
                                                              
                                                              Äæ
                                                              10000111
                                                              ABABABAB
                                                              
C51 COMPILER V9.60.0.0   CODINGSWITCH                                                      05/09/2023 16:49:07 PAGE 6   

                                                              */
                                                      #if     (c_codingSwitch_strengthenMode==0)              //¼ì²âÇ¿¶ÈµÈ¼¶0~2£¬ÖµÔ½´ó¿¹¸ÉÈÅÐÔÔ½Ç¿µ«Ò²Ðí»á´Ë³öÏÖÐ¡¸ÅÂÊµÄÂ©
             -¼ì
                                                              bs_codingSwitch2.status=bs_codingSwitch2.status&0xf0;
                                                              if(bs_codingSwitch2.status==b(01000000))
                                                              {                               
                                                                      bs_codingSwitch2.value=1;
                                                              }
                                                              else if(bs_codingSwitch2.status==b(10000000))
                                                              {
                                                                      bs_codingSwitch2.value=2;
                                                              }
                                                              else
                                                              {
                                                                      bs_codingSwitch2.value=0;
                                                              }
                                                      #elif   (c_codingSwitch_strengthenMode==1)      //¼ì²âÇ¿¶ÈµÈ¼¶0~2£¬ÖµÔ½´ó¿¹¸ÉÈÅÐÔÔ½Ç¿µ«Ò²Ðí»á´Ë³öÏÖÐ¡¸ÅÂÊµÄÂ
             -©¼ì
                                                              bs_codingSwitch2.status=bs_codingSwitch2.status&0xfc;   //1111 1100
                                                              if(bs_codingSwitch2.status==b(01001000))
                                                              {                               
                                                                      bs_codingSwitch2.value=1;       //1:Õý×ª
                                                              }
                                                              else if(bs_codingSwitch2.status==b(10000100))
                                                              {
                                                                      bs_codingSwitch2.value=2;       //2:·´×ª
                                                              }
                                                              else
                                                              {
                                                                      bs_codingSwitch2.value=0;       //0:ÎÞ¶¯×÷
                                                              }
                                                      #else                                                                           //¼ì²âÇ¿¶ÈµÈ¼¶0~2£¬ÖµÔ½´ó¿¹¸ÉÈÅÐÔÔ½Ç¿µ«Ò²Ðí»á´Ë³öÏÖÐ¡¸ÅÂÊµÄÂ©¼ì
                                                              if(bs_codingSwitch2.status==b(01001011))
                                                              {                               
                                                                      bs_codingSwitch2.value=1;
                                                              }
                                                              else if(bs_codingSwitch2.status==b(10000111))
                                                              {
                                                                      bs_codingSwitch2.value=2;
                                                              }
                                                              else
                                                              {
                                                                      bs_codingSwitch2.value=0;
                                                              }       
                                                      #endif          
                                                              bs_codingSwitch2.order=0;               //´ÎÊý¼ÆÊý,Ò»¸öÖÜÆÚÓÐ4´Î
                                                              bs_codingSwitch2.status=0x03;   //ÓÃÓÚ´æ´¢Ò»¸öÖÜÆÚÀïµÄÖµ,³õÊ¼»¯Îª0x03
                                                              bs_codingSwitch2.getOne=1;              //1:»ñÈ¡ÁËÐý×ªÖµ
                                                                      
                                                      }
                                                      else
                                                      {
                                                              //²»ÊÇµÚ4´ÎÈ´¶Áµ½11ÔòÈÏÎª´íÎóÖØÐÂ¿ªÊ¼¶ÁÈ¡
                                                              if(i==0x03)
                                                              {
                                                                      bs_codingSwitch2.order=0;
                                                                      bs_codingSwitch2.status=0x03;   
                                                              }
              
                                                      }
                                              }
                                      }
C51 COMPILER V9.60.0.0   CODINGSWITCH                                                      05/09/2023 16:49:07 PAGE 7   

                                      else
                                      {
                                              buf=i;
                                              bs_codingSwitch2.io_differCnt=0;                //Ïû¶¶¼ÆÊý
                                      }
                              }
                              else
                              {
                                      bs_codingSwitch2.io_differCnt=0;                        //Ïû¶¶¼ÆÊý
                                      buf=i;
                              }
                                                      
                      }
              
              /***********************************************************
              ;º¯ÊýÃû³Æ:uchar codingSwitch_get(void)
              ;º¯Êý¹¦ÄÜ:»ñÈ¡±àÂë¿ª¹Ø×´Ì¬
              ;ÊäÈë²ÎÊý:ÎÞ
              ;Êä³ö²ÎÊý:              
                               0:ÎÞ¶¯×÷
                               1:Õý×ª
                               2:·´×ª
              ;Ê¹ÓÃ×¢Òâ:
              ;--------
              ;---------
              ;---------
              ;**********************************************************/
                      uchar   codingSwitch_get(void)
                      {                                               
                              uchar   i=0;            
                              if(bs_codingSwitch.getOne)
                              {
                                      bs_codingSwitch.getOne=0;
                                      i=bs_codingSwitch.value;
                                      bs_codingSwitch.value=0;                                
                              }
                              return  i;              
                      }
              
              
              
              /***********************************************************
              ;º¯ÊýÃû³Æ:uchar codingSwitch_get2(void)
              ;º¯Êý¹¦ÄÜ:»ñÈ¡±àÂë¿ª¹Ø×´Ì¬(Ðý×ª±àÂë¿ª¹Ø2)
              ;ÊäÈë²ÎÊý:ÎÞ
              ;Êä³ö²ÎÊý:              
                               0:ÎÞ¶¯×÷
                               1:Õý×ª
                               2:·´×ª
              ;Ê¹ÓÃ×¢Òâ:
              ;--------
              ;---------
              ;---------
              ;**********************************************************/
                      uchar   codingSwitch_get2(void)
                      {                                               
                              uchar   i=0;            
                              if(bs_codingSwitch2.getOne)
                              {
                                      bs_codingSwitch2.getOne=0;
                                      i=bs_codingSwitch2.value;
                                      bs_codingSwitch2.value=0;                               
C51 COMPILER V9.60.0.0   CODINGSWITCH                                                      05/09/2023 16:49:07 PAGE 8   

                              }
                              return  i;              
                      }
              
              
              
              
              
              
              
              
              #endif


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   ----    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
