C51 COMPILER V9.60.0.0   XS16TK06X_IDLE                                                    05/09/2023 16:49:06 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE XS16TK06X_IDLE
OBJECT MODULE PLACED IN .\Output\XS16TK06X_Idle.obj
COMPILER INVOKED BY: D:\Program_Files\KEIL5_521A\C51\BIN\C51.EXE Source\XS16TK06X_Idle.c OMF2 OPTIMIZE(8,SPEED) BROWSE I
                    -NCDIR(.\Inc;.\User;.\Application_Library;.\Project) DEBUG PRINT(.\List\XS16TK06X_Idle.lst) OBJECT(.\Output\XS16TK06X_Idl
                    -e.obj)

line level    source

   1          #include "Config.h"
   2          
   3          
   4          #if IDLE_MODE
                      uint Idle_Cnt = 0;
                      bit Idle_Flag = 0;
                      uint Idle_Wait_Count = 0;
                      uint xdata Idle_Time_Count = 0;
                      uint xdata Idle_Time_Count1 = 0;
                      uint xdata Step_In_Idle_Time = 0;
                      uint xdata Idle_Wake_Up_Time = 0;
                      
                      unsigned int  xdata raw_data_parallel[1] =  {0};
                      unsigned int  xdata base_line_parallel[1] = {0};        
                      unsigned char xdata Cnt_Par[4] = 0;
              #endif
  17          
  18          #if IDLE_MODE
              
                      #pragma message "±àÒë£¬Idle¹¦ÄÜÏà¹Øº¯Êý"
              
                      //-----------------------------------------------------------------//
                      //º¯ÊýÃû³Æ£º Idle_IORecovrey()
                      //º¯Êý¹¦ÄÜ£º »½ÐÑºó£¬½«Ê¹ÓÃµÄÓ¦ÓÃµÄIO¿ÚÉèÖÃ³ÉÐèÒªµÄ×´Ì¬
                      //ÊäÈë²ÎÊý£º ÎÞ
                      //Êä³ö²ÎÊý£º ÎÞ
                      //·µ »Ø Öµ£º ÎÞ
                      //-----------------------------------------------------------------//
                      void Idle_IORecovrey()
                      {
                      //¸ù¾ÝÓ¦ÓÃ»¹Ô­IO¿Ú×´Ì¬
                      }
                      //-----------------------------------------------------------------//
                      //º¯ÊýÃû³Æ£º void Idle_Delay_Us(uint us)
                      //º¯Êý¹¦ÄÜ£º ÑÓÊ±Îª¼¸us
                      //ÊäÈë²ÎÊý£º us
                      //Êä³ö²ÎÊý£º ÎÞ
                      //·µ »Ø Öµ£º ÎÞ
                      //-----------------------------------------------------------------//
                      void Idle_Delay_Us(uint us)//1--2.38us@12MHz;10-11.8us@12MHz;100-106us@12MHz;1000-1.045ms
                      {
                              for (; us > 0; us--)
                              {       
                                      WDT_CTRL = 0x07;
                              }               
                      }
              
                      //-----------------------------------------------------------------//
                      //º¯ÊýÃû³Æ£º Idle_IO_Init()
                      //º¯Êý¹¦ÄÜ£º IdleÄ£Ê½³õÊ¼»¯IO,½¨Òé½«Î´ÓÃµ½µÄIO¿ÚÉèÖÃÎªÊä³öÎªµÍ
                      //ÊäÈë²ÎÊý£º ÎÞ
                      //Êä³ö²ÎÊý£º ÎÞ
                      //·µ »Ø Öµ£º ÎÞ
C51 COMPILER V9.60.0.0   XS16TK06X_IDLE                                                    05/09/2023 16:49:06 PAGE 2   

                      //-----------------------------------------------------------------//
                      void Idle_IO_Init()
                      {
              
                      }
              
                      //-----------------------------------------------------------------//
                      //º¯ÊýÃû³Æ£º void Idle_Wake_Up_Init(uint _Step_In_Idle_Time,uint _Idle_Wake_Up_Time)
                      //º¯Êý¹¦ÄÜ£º IdleÄ£Ê½³õÊ¼»¯ÉèÖÃ
                      //ÊäÈë²ÎÊý£º uint _Step_In_Idle_TimeÎªÁ¬ÐøÎÞ°´¼ü´¥Ãþ_Step_In_Idle_TimeºÁÃëºó½øÈëË¯ÃßÄ£Ê½(½¨Òé>=5000),¸ÃÖµ
             -±ØÐë´óÓÚÒ»ÂÖkeysFlagSNÖÃÎ»µÄÊ±¼ä
                      //                                              uint _Idle_Wake_Up_Time,WDT»½ÐÑÊ±¼ä0~7
                      //Êä³ö²ÎÊý£º ÎÞ
                      //·µ »Ø Öµ£º ÎÞ
                      //-----------------------------------------------------------------//
                      void Idle_Wake_Up_Init(uint _Step_In_Idle_Time,uint _Idle_Wake_Up_Time)
                      {
                              Idle_IO_Init();
                              Step_In_Idle_Time = _Step_In_Idle_Time;//¿ªÆôTime0£¬Timer0ÖÐ¶Ïº¯ÊýÖÐÊ¹ÓÃ¡£
                              Idle_Wake_Up_Time = _Idle_Wake_Up_Time;
              
                      }
                      //-----------------------------------------------------------------//
                      //º¯ÊýÃû³Æ£º void Idle()
                      //º¯Êý¹¦ÄÜ£º ½øÈëIdleÄ£Ê½º¯Êý£¬¸ù¾ÝÊµ¼ÊÓ¦ÓÃÇé¿ö½øÐÐÖÐ¶ÏµÄ¿ª¹Ø¼°IOÅäÖÃ£¬
                      //ÅäÖÃÁËÊÖÖ¸´¥Ãþºó½øÈëË¯ÃßµÄÊ±¼äÒÔ¼°Îª´¥ÃþÊ±É¨Ãè°´¼üµÄÊ±¼ä
                      //ÊäÈë²ÎÊý£º ÎÞ
                      //Êä³ö²ÎÊý£º ÎÞ
                      //·µ »Ø Öµ£º ÎÞ
                      //-----------------------------------------------------------------//
                      void Idle()
                      {
                              long differ_para = 0;
                              if(Idle_Flag == 1)
                              {
                                      #if SNS_NUM
                                      if(ctk_para_done == 1)//ÖÐ¶ÏÉ¨ÃèÍêÒ»ÂÖ
                                      {
                                                      
                                                              CTK_IE_CLR;//¹ØCTKÖÐ¶Ï
                                                              differ_para = ((long)base_line_parallel[0] - (long)raw_data_parallel[0]);
                                                      
                                                              if(differ_para >= 0)
                                                              {
                                                                      if(differ_para >= FTH_PARA)
                                                                      {
                                                                              
              
                                                                                      Cnt_Par[0]++;
                                                                                      if(Cnt_Par[0] >= 0)
                                                                                      {
                                                                                                      
                                                                                                      Cnt_Par[0]= 0; 
                                                                                              
                                                                                                      Idle_Flag = 0;
                                                                                                      parallel_mode = 0;
                                                                                                      
                                                                                              
                                                                                                      differ_para = 0;
                                                                                                      Idle_Time_Count1 = 0;
                                                                                                      Idle_Wait_Count = 0;
                                                                                                              
C51 COMPILER V9.60.0.0   XS16TK06X_IDLE                                                    05/09/2023 16:49:06 PAGE 3   

                                                                                      }
                                                                                      Cnt_Par[1] = 0;
                                                                                      Cnt_Par[2] = 0;
                                                                                      Cnt_Par[3] = 0;
                                                                                      
                                                                      }
                                                                      else if(differ_para >= FTH_PARA/5)
                                                                      {
                                                                                      Cnt_Par[1]++;
                                                                                      if(Cnt_Par[1] >= PAR_PnoiseRenMaxCnt)
                                                                                      {
                                                                                                      Cnt_Par[1]= 0; 
                                                                                                      base_line_parallel[0] -= 5;
                                                                                      }
                                                                                      Cnt_Par[0] = 0;
                                                                                      Cnt_Par[2] = 0;
                                                                                      Cnt_Par[3] = 0;
                                                                              
                                                                              
                                                                      }
                                                                      
                                                                      else if(differ_para >= 0)
                                                                      {
                                                                                      Cnt_Par[2]++;
                                                                                      if(Cnt_Par[2] >= PAR_PnoiseRenMaxCnt)
                                                                                      {
                                                                                                      Cnt_Par[2]= 0; 
                                                                                                      base_line_parallel[0]--;
                                                                                      }
                                                                                      Cnt_Par[0] = 0;
                                                                                      Cnt_Par[1] = 0;
                                                                                      Cnt_Par[3] = 0;
                                                                                      
                                                                      }
                                                              }
                                                              else
                                                              {
              
                                                                              Cnt_Par[3]++;
                                                                              if(Cnt_Par[3] >= PAR_NnoiseRenMaxCnt)
                                                                              {
                                                                                              Cnt_Par[3]= 0; 
                                                                                              base_line_parallel[0] = raw_data_parallel[0];
                                                                              }
                                                                              Cnt_Par[0] = 0;
                                                                              Cnt_Par[1] = 0;
                                                                              Cnt_Par[2] = 0;
                                                              }
                                                      
                                                              
                                                              CTK_IE_SET;//¿ªCTKÖÐ¶Ï
                                                      
                                                      
                                                      #if (TRACEMODE == 0)
                                                              if(Idle_Flag == 1)
                                                              {
              
                                                                      Idle_IO_Init();
              
                                                                      CTK_STOP;
                                                                      CTK_IE_CLR;//¹ØCTKÖÐ¶Ï
                                                                      CTK_PD_SET(1);//0ÎªCTK¿ª£¬1ÎªCTK¹Ø
C51 COMPILER V9.60.0.0   XS16TK06X_IDLE                                                    05/09/2023 16:49:06 PAGE 4   

                                      
                                                                      Idle_Delay_Us(100);//Ö´ÐÐPCON = 0x01Ç°ÑÓÊ±>=100us
                                                                      
                                                                      WDT_CTRL = Idle_Wake_Up_Time;//ÉèÖÃ¿´ÃÅ¹·Òç³öÊ±¼ä
                                                                      PCON = 0x01;//½øÈëÊ¡µçÄ£Ê½µÈ´ý»½ÐÑ,ÔÚ½øÈëÊ¡µçÄ£Ê½Ö®Ç°£¬¸ù¾ÝÊµ¼ÊÓ¦ÓÃÇé¿öÀ´¹Ø±Õ/¿ªÆôÄ£¿é¼°ÖÐ¶Ï£¬»½ÐÑº
             -ó¸ù¾ÝÊµ¼ÊÓ¦ÓÃÇé¿öÀ´»Ö¸´Ä£¿é
                                                                      
                                                                      
                                                                      BOR_ON;//¿ªµôµç¸´Î»¹¦ÄÜ
                                                                      CTK_PD_SET(0);//0ÎªCTK¿ª£¬1ÎªCTK¹Ø
                                                                      CTK_IE_SET;//¿ªCTKÖÐ¶Ï
                                                                      CTK_START;
                                                      
                                                              
                                                                      Idle_IORecovrey();
              
                                                              }
                                                      #endif  
                                                      
                                                      ctk_para_done = 0;
                                      }
                                      
                                              #if TRACEMODE
                                      
                                                                      raw_data[25] = raw_data_parallel[0];
                                                                      base_line[25] = base_line_parallel[0];//²é¿´²¢ÁªÄ£Ê½Êý¾ÝÊ±£¬raw_data[25]¶ÔÓ¦µÄSNS¹Ø±Õ
                                                              
                                              #endif
                                      #endif
                                      
                              }//IDLE
                              else
                              {
                                              #if TRACEMODE
                              
                                                              raw_data[25] = raw_data_parallel[0];
                                                              base_line[25] = base_line_parallel[0];//²é¿´²¢ÁªÄ£Ê½Êý¾ÝÊ±£¬raw_data[25]¶ÔÓ¦µÄSNS¹Ø±Õ
                                                      
                                              #endif
                              }
                      }       
              #endif  
 218                          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   ----    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
